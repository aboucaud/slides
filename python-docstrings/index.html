<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <title>Astropy Docstring Rules</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="reveal.js/css/reveal.css">
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="reveal.js/css/theme/black.css" id="theme">
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>
  <!--[if lt IE 9]>
  <script src="reveal.js/lib/js/html5shiv.js"></script>
  <![endif]-->
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section>
  <h1 class="title">Astropy Docstring Rules</h1>
</section>

<section class="slide level1">

<p>The original source for these docstring standards is the <a href="http://numpy.scipy.org/">NumPy</a> project, and the associated <a href="http://pypi.python.org/pypi/numpydoc/0.3.1">numpydoc</a> tools. The most up-to-date version of these standards can be found at <a href="http://github.com/numpy/numpy/blob/master/doc/HOWTO_DOCUMENT.rst.txt">numpy's github site</a>. The guidelines below have been adapted to the Astropy package.</p>
</section>
<section id="overview" class="slide level1">
<h1>Overview</h1>
<p>In general, we follow the standard Python style conventions as described here:</p>
<ul>
<li><a href="http://www.python.org/peps/pep-0007.html">Style Guide for C Code</a></li>
<li><a href="http://www.python.org/peps/pep-0008.html">Style Guide for Python Code</a></li>
<li><a href="http://www.python.org/peps/pep-0257.html">Docstring Conventions</a></li>
</ul>
<p>Additional PEPs of interest regarding documentation of code:</p>
<ul>
<li><a href="http://www.python.org/peps/pep-0256.html">Docstring Processing Framework</a></li>
<li><a href="http://www.python.org/peps/pep-0258.html">Docutils Design Specification</a></li>
</ul>
<p>Use a code checker:</p>
<ul>
<li><a href="http://www.logilab.org/857">pylint</a></li>
<li><a href="http://pypi.python.org/pypi/pyflakes">pyflakes</a></li>
<li><a href="https://github.com/jcrocholl/pep8">pep8.py</a></li>
</ul>
<p>The following import conventions are used throughout the Astropy source and documentation:</p>
<pre><code>import numpy as np
import matplotlib as mpl
import matplotlib.pyplot as plt</code></pre>
<p>Do not abbreviate <code>scipy</code>. There is no motivating use case to abbreviate it in the real world, so we avoid it in the documentation to avoid confusion.</p>
<p>It is not necessary to do <code>import numpy as np</code> at the beginning of an example. However, some sub-modules, such as <code>fft</code>, are not imported by default, and you have to include them explicitly:</p>
<pre><code>import numpy.fft</code></pre>
<p>after which you may use it:</p>
<pre><code>np.fft.fft2(...)</code></pre>
</section>
<section id="docstring-standard" class="slide level1">
<h1>Docstring Standard</h1>
<p>A documentation string (docstring) is a string that describes a module, function, class, or method definition. The docstring is a special attribute of the object (<code>object.__doc__</code>) and, for consistency, is surrounded by triple double quotes, i.e.:</p>
<pre><code>&quot;&quot;&quot;This is the form of a docstring.

It can be spread over several lines.

&quot;&quot;&quot;</code></pre>
<p><a href="http://numpy.scipy.org/">NumPy</a> and <a href="http://www.scipy.org">SciPy</a> have defined a common convention for docstrings that provides for consistency, while also allowing our toolchain to produce well-formatted reference guides. This format should be used for Astropy docstrings.</p>
<p>This docstring standard uses <a href="http://docutils.sourceforge.net/rst.html">re-structured text (reST)</a> syntax and is rendered using <a href="http://sphinx.pocoo.org">Sphinx</a> (a pre-processor that understands the particular documentation style we are using). While a rich set of markup is available, we limit ourselves to a very basic subset, in order to provide docstrings that are easy to read on text-only terminals.</p>
<p>A guiding principle is that human readers of the text are given precedence over contorting docstrings so our tools produce nice output. Rather than sacrificing the readability of the docstrings, we have written pre-processors to assist <a href="http://sphinx.pocoo.org">Sphinx</a> in its task.</p>
<p>The length of docstring lines should be kept to 75 characters to facilitate reading the docstrings in text terminals.</p>
</section>
<section id="sections" class="slide level1">
<h1>Sections</h1>
<p>The sections of the docstring are:</p>
<ol type="1">
<li class="fragment"><p><strong>Short summary</strong></p>
<p>A one-line summary that does not use variable names or the function name, e.g.</p>
<pre><code>def add(a, b):
   &quot;&quot;&quot;The sum of two numbers.

   &quot;&quot;&quot;</code></pre>
<p>The function signature is normally found by introspection and displayed by the help function. For some functions (notably those written in C) the signature is not available, so we have to specify it as the first line of the docstring:</p>
<pre><code>&quot;&quot;&quot;
add(a, b)

The sum of two numbers.

&quot;&quot;&quot;</code></pre></li>
<li class="fragment"><p><strong>Deprecation warning</strong></p>
<p>A section (use if applicable) to warn users that the object is deprecated. Section contents should include:</p>
<ul>
<li class="fragment">In what Astropy version the object was deprecated, and when it will be removed.</li>
<li class="fragment">Reason for deprecation if this is useful information (e.g., object is superseded, duplicates functionality found elsewhere, etc.).</li>
<li class="fragment">New recommended way of obtaining the same functionality.</li>
</ul>
<p>This section should use the note Sphinx directive instead of an underlined section header.</p>
<pre><code>.. note:: Deprecated in Astropy 1.2
          `ndobj_old` will be removed in Astropy 2.0, it is replaced by
          `ndobj_new` because the latter works also with array subclasses.</code></pre></li>
<li class="fragment"><p><strong>Extended summary</strong></p>
<p>A few sentences giving an extended description. This section should be used to clarify <em>functionality</em>, not to discuss implementation detail or background theory, which should rather be explored in the <strong>notes</strong> section below. You may refer to the parameters and the function name, but parameter descriptions still belong in the <strong>parameters</strong> section.</p></li>
<li class="fragment"><p><strong>Parameters</strong></p>
<p>Description of the function arguments, keywords and their respective types.</p>
<pre><code>Parameters
----------
x : type
   Description of parameter `x`.</code></pre>
<p>Enclose variables in single backticks.</p>
<p>For the parameter types, be as precise as possible. Below are a few examples of parameters and their types.</p>
<pre><code>Parameters
----------
filename : str
copy : bool
dtype : data-type
iterable : iterable object
shape : int or tuple of int
files : list of str</code></pre>
<p>If it is not necessary to specify a keyword argument, use <code>optional</code>:</p>
<pre><code>x : int, optional</code></pre>
<p>Optional keyword parameters have default values, which are displayed as part of the function signature. They can also be detailed in the description:</p>
<pre><code>Description of parameter `x` (the default is -1, which implies summation
over all axes).</code></pre>
<p>When a parameter can only assume one of a fixed set of values, those values can be listed in braces:</p>
<pre><code>order : {&#39;C&#39;, &#39;F&#39;, &#39;A&#39;}
    Description of `order`.</code></pre>
<p>When two or more input parameters have exactly the same type, shape and description, they can be combined:</p>
<pre><code>x1, x2 : array-like
    Input arrays, description of `x1`, `x2`.</code></pre></li>
<li class="fragment"><p><strong>Returns</strong></p>
<p>Explanation of the returned values and their types, of the same format as <strong>parameters</strong>.</p></li>
<li class="fragment"><p><strong>Other parameters</strong></p>
<p>An optional section used to describe infrequently used parameters. It should only be used if a function has a large number of keyword parameters, to prevent cluttering the <strong>parameters</strong> section.</p></li>
<li class="fragment"><p><strong>Raises</strong></p>
<p>An optional section detailing which errors get raised and under what conditions:</p>
<pre><code>Raises
------
InvalidWCSException
    If the WCS information is invalid.</code></pre>
<p>This section should be used judiciously, i.e only for errors that are non-obvious or have a large chance of getting raised.</p></li>
<li class="fragment"><p><strong>See Also</strong></p>
<p>An optional section used to refer to related code. This section can be very useful, but should be used judiciously. The goal is to direct users to other functions they may not be aware of, or have easy means of discovering (by looking at the module docstring, for example). Routines whose docstrings further explain parameters used by this function are good candidates.</p>
<p>As an example, for a hypothetical function <code>astropy.wcs.world2pix</code> converting sky to pixel coordinates, we would have:</p>
<pre><code>See Also
--------
pix2world : Convert pixel to sky coordinates</code></pre>
<p>When referring to functions in the same sub-module, no prefix is needed, and the tree is searched upwards for a match.</p>
<p>Prefix functions from other sub-modules appropriately. E.g., whilst documenting a hypothetical <code>astropy.vo</code> module, refer to a function in <code>table</code> by</p>
<pre><code>table.read : Read in a VO table</code></pre>
<p>When referring to an entirely different module:</p>
<pre><code>astropy.coords : Coordinate handling routines</code></pre>
<p>Functions may be listed without descriptions, and this is preferable if the functionality is clear from the function name:</p>
<pre><code>See Also
--------
func_a : Function a with its description.
func_b, func_c_, func_d
func_e</code></pre></li>
<li class="fragment"><p><strong>Notes</strong></p>
<p>An optional section that provides additional information about the code, possibly including a discussion of the algorithm. This section may include mathematical equations, written in <a href="http://www.latex-project.org/">LaTeX</a> format:</p>
<pre><code>The FFT is a fast implementation of the discrete Fourier transform:

.. math:: X(e^{j\omega } ) = x(n)e^{ - j\omega n}</code></pre>
<p>Equations can also be typeset underneath the math directive:</p>
<pre><code>The discrete-time Fourier time-convolution property states that

.. math::

     x(n) * y(n) \Leftrightarrow X(e^{j\omega } )Y(e^{j\omega } )\\
     another equation here</code></pre>
<p>Math can furthermore be used inline, i.e.</p>
<pre><code>The value of :math:`\omega` is larger than 5.</code></pre>
<p>Variable names are displayed in typewriter font, obtained by using <code>\mathtt{var}</code>:</p>
<pre><code>We square the input parameter `alpha` to obtain
:math:`\mathtt{alpha}^2`.</code></pre>
<p>Note that LaTeX is not particularly easy to read, so use equations sparingly.</p>
<p>Images are allowed, but should not be central to the explanation; users viewing the docstring as text must be able to comprehend its meaning without resorting to an image viewer. These additional illustrations are included using:</p>
<pre><code>.. image:: filename</code></pre>
<p>where filename is a path relative to the reference guide source directory.</p></li>
<li class="fragment"><strong>References</strong></li>
</ol>
<blockquote>
<p>References cited in the <strong>notes</strong> section may be listed here, e.g. if you cited the article below using the text <code>[1]_</code>, include it as in the list as follows:</p>
<pre><code>.. [1] O. McNoleg, &quot;The integration of GIS, remote sensing,
   expert systems and adaptive co-kriging for environmental habitat
   modelling of the Highland Haggis using object-oriented, fuzzy-logic
   and neural-network techniques,&quot; Computers &amp; Geosciences, vol. 22,
   pp. 585-588, 1996.</code></pre>
<p>which renders as</p>
<p>Referencing sources of a temporary nature, like web pages, is discouraged. References are meant to augment the docstring, but should not be required to understand it. References are numbered, starting from one, in the order in which they are cited.</p>
</blockquote>
<ol start="11" type="1">
<li class="fragment"><strong>Examples</strong></li>
</ol>
<blockquote>
<p>An optional section for examples, using the <a href="http://docs.python.org/library/doctest.html">doctest</a> format. This section is meant to illustrate usage, not to provide a testing framework -- for that, use the <code>tests/</code> directory. While optional, this section is very strongly encouraged.</p>
<p>When multiple examples are provided, they should be separated by blank lines. Comments explaining the examples should have blank lines both above and below them:</p>
<pre><code>&gt;&gt;&gt; astropy.wcs.world2pix(233.2, -12.3)
(134.5, 233.1)

Comment explaining the second example

&gt;&gt;&gt; astropy.coords.fk5_to_gal(&quot;00:42:44.33 +41:16:07.5&quot;)
(121.1743, -21.5733)</code></pre>
<p>For tests with a result that is random or platform-dependent, mark the output as such:</p>
<pre><code>&gt;&gt;&gt; astropy.coords.randomize_position(244.9, 44.2, radius=0.1)
(244.855, 44.13)  # random</code></pre>
<p>It is not necessary to use the doctest markup <code>&lt;BLANKLINE&gt;</code> to indicate empty lines in the output. The examples may assume that <code>import numpy as np</code> is executed before the example code.</p>
</blockquote>
</section>
<section id="documenting-classes" class="slide level1">
<h1>Documenting classes</h1>
<h2 id="class-docstrings">Class docstrings</h2>
<p>Use the same sections as outlined above (all except <code>Returns</code> are applicable). The constructor (<code>__init__</code>) should also be documented here, the <code>Parameters</code> section of the docstring details the constructors parameters.</p>
<p>An <code>Attributes</code> section, located below the <code>Parameters</code> section, may be used to describe class variables:</p>
<pre><code>Attributes
----------
x : float
    The X coordinate.
y : float
    The Y coordinate.</code></pre>
<p>Attributes that are properties and have their own docstrings can be simply listed by name:</p>
<pre><code>Attributes
----------
real
imag
x : float
    The X coordinate
y : float
    The Y coordinate</code></pre>
<p>In general, it is not necessary to list class methods. Those that are not part of the public API have names that start with an underscore. In some cases, however, a class may have a great many methods, of which only a few are relevant (e.g., subclasses of ndarray). Then, it becomes useful to have an additional <code>Methods</code> section:</p>
<pre><code>class Table(ndarray):
    &quot;&quot;&quot;
    A class to represent tables of data

    ...

    Attributes
    ----------
    columns : list
        List of columns

    Methods
    -------
    read(filename)
        Read a table from a file
    sort(column, order=&#39;ascending&#39;)
        Sort by `column`
    &quot;&quot;&quot;</code></pre>
<p>If it is necessary to explain a private method (use with care!), it can be referred to in the <strong>extended summary</strong> or the <strong>notes</strong>. Do not list private methods in the Methods section.</p>
<p>Do not list <code>self</code> as the first parameter of a method.</p>
<h2 id="method-docstrings">Method docstrings</h2>
<p>Document these as you would any other function. Do not include <code>self</code> in the list of parameters. If a method has an equivalent function, the function docstring should contain the detailed documentation, and the method docstring should refer to it. Only put brief <code>Summary</code> and <code>See Also</code> sections in the method docstring.</p>
</section>
<section id="documenting-class-instances" class="slide level1">
<h1>Documenting class instances</h1>
<p>Instances of classes that are part of the Astropy API may require some care. To give these instances a useful docstring, we do the following:</p>
<ul>
<li class="fragment">Single instance: If only a single instance of a class is exposed, document the class. Examples can use the instance name.</li>
<li class="fragment">Multiple instances: If multiple instances are exposed, docstrings for each instance are written and assigned to the instances' <code>__doc__</code> attributes at run time. The class is documented as usual, and the exposed instances can be mentioned in the Notes and See Also sections.</li>
</ul>
</section>
<section id="documenting-constants" class="slide level1">
<h1>Documenting constants</h1>
<p>Use the same sections as outlined for functions where applicable:</p>
<pre><code>1. summary
2. extended summary (optional)
3. see also (optional)
4. references (optional)
5. examples (optional)</code></pre>
<p>Docstrings for constants will not be visible in text terminals (constants are of immutable type, so docstrings can not be assigned to them like for for class instances), but will appear in the documentation built with Sphinx.</p>
</section>
<section id="documenting-modules" class="slide level1">
<h1>Documenting modules</h1>
<p>Each module should have a docstring with at least a summary line. Other sections are optional, and should be used in the same order as for documenting functions when they are appropriate:</p>
<pre><code>1. summary
2. extended summary
3. routine listings
4. see also
5. notes
6. references
7. examples</code></pre>
<p>Routine listings are encouraged, especially for large modules, for which it is hard to get a good overview of all functionality provided by looking at the source file(s) or the <code>__all__</code> dict.</p>
<p>Note that license and author info, while often included in source files, do not belong in docstrings.</p>
</section>
<section id="other-points-to-keep-in-mind" class="slide level1">
<h1>Other points to keep in mind</h1>
<ul>
<li class="fragment"><p>Notes and Warnings : If there are points in the docstring that deserve special emphasis, the reST directives for a note or warning can be used in the vicinity of the context of the warning (inside a section). Syntax:</p>
<pre><code>.. warning:: Warning text.

.. note:: Note text.</code></pre>
<p>Use these sparingly, as they do not look very good in text terminals and are not often necessary. One situation in which a warning can be useful is for marking a known bug that is not yet fixed.</p></li>
<li class="fragment">Questions and Answers : For general questions on how to write docstrings that are not answered in this document, refer to <a href="http://docs-old.scipy.org/numpy/Questions+Answers/" class="uri">http://docs-old.scipy.org/numpy/Questions+Answers/</a>.</li>
<li class="fragment"><code>array-like</code> : For functions that take arguments which can have not only a type <code>ndarray</code>, but also types that can be converted to an ndarray (i.e. scalar types, sequence types), those arguments can be documented with type <code>array-like</code>.</li>
</ul>
</section>
<section id="common-rest-concepts" class="slide level1">
<h1>Common reST concepts</h1>
<p>For paragraphs, indentation is significant and indicates indentation in the output. New paragraphs are marked with a blank line.</p>
<p>Use <em>italics</em>, <strong>bold</strong>, and <code>courier</code> if needed in any explanations (but not for variable names and doctest code or multi-line code). Variable, module and class names should be written between single back-ticks (<code>`astropy</code>).

A more extensive example of reST markup can be found in this example document &lt;<a href="http://docutils.sourceforge.net/docs/user/rst/demo.txt" class="uri">http://docutils.sourceforge.net/docs/user/rst/demo.txt</a>&gt;_; the quick reference &lt;<a href="http://docutils.sourceforge.net/docs/user/rst/quickref.html" class="uri">http://docutils.sourceforge.net/docs/user/rst/quickref.html</a>&gt;_ is
useful while editing.

Line spacing and indentation are significant and should be carefully followed.

Conclusion
----------

An example &lt;<a href="http://github.com/numpy/numpy/blob/master/doc/example.py" class="uri">http://github.com/numpy/numpy/blob/master/doc/example.py</a>&gt;_ of the
format shown here is available.  Refer to How to Build API/Reference Documentation &lt;<a href="https://github.com/numpy/numpy/blob/master/doc/HOWTO_BUILD_DOCS.rst.txt" class="uri">https://github.com/numpy/numpy/blob/master/doc/HOWTO_BUILD_DOCS.rst.txt</a>&gt;`_ on how to use <a href="http://sphinx.pocoo.org">Sphinx</a> to build the manual.</p>
</section>
    </div>
  </div>

  <script src="reveal.js/lib/js/head.min.js"></script>
  <script src="reveal.js/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({

        // Optional reveal.js plugins
        dependencies: [
          { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
          { src: 'reveal.js/plugin/notes/notes.js', async: true }
        ]
      });
    </script>
    </body>
</html>
